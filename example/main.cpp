#include <bits/stdc++.h>
#include "../src/bp-monitor.h"
 
using namespace std; 

int main(){
      BP_MONITOR m;
      // Sample of blood pressure wave
      int sample[] = {80,80,80,80,80,80,80,81,81,85,92,100,106,116,119,119,119,117,115,110,
            107,107,107,108,107,105,100,99,97,93,92,90,87,86,84,83,83,82,82,82,
            82,81,81,81,81,80,80,80,80,80,80,80,80,80,80,80,81,81,85,92,
            106,112,116,119,119,119,117,112,110,107,107,108,108,105,102,100,97,95,93,90,
            89,87,84,84,83,83,82,82,82,81,81,81,81,80,80,80,80,80,80,80,
            80,80,80,80,80,81,81,85,100,106,112,119,119,119,117,115,112,107,107,107,
            108,107,105,100,99,97,95,92,90,89,86,84,84,83,82,82,82,82,81,81,
            81,81,80,80,80,80,80,80,80,80,80,80,80,81,81,85,92,100,112,116,
            119,119,120,117,112,110,107,107,108,108,107,102,100,99,95,93,92,89,87,86,
            84,83,83,82,82,82,82,81,81,81,80,80,80,80,80,80,80,80,80,80,
            80,80,81,81,85,100,106,112,116,119,119,119,115,112,110,107,107,108,107,105};
      // Size of array
      int n = sizeof(sample) / sizeof(*sample);
      int index;
      // Test
      cout << "Enter index: ";
      cin >> index;
      cout << "running...";
      try{      
            BP result = m.measure(sample, n, index);
            cout << "done!" << std::endl;
            cout << "systolic " << result.DBP << " @ index: " << result.DBPi << std::endl;
            cout << "diastolic " << result.SBP << " @ index: " << result.SBPi << std::endl;
      } catch (std::exception& e) {
            std::cerr << std::endl << "ERROR: " << e.what() << std::endl;
      }
}
